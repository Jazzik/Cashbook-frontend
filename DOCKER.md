# Docker Setup for CashBook Frontend

Эта документация описывает процесс контейнеризации и запуска фронтенд-приложения CashBook с помощью Docker.

## Предварительные требования

- [Docker](https://docs.docker.com/get-docker/), установленный в вашей системе
- [Docker Compose](https://docs.docker.com/compose/install/) (опционально, но рекомендуется)
- Скомпилированная сборка приложения в папке `build/`

## Сборка и запуск с Docker

### Вариант 1: Использование Docker напрямую

1. Убедитесь, что у вас есть скомпилированное приложение в папке `build/`:

   ```bash
   npm run build
   ```

   (Если папка build уже содержит актуальную версию приложения, этот шаг можно пропустить)

2. Соберите Docker-образ:

   ```bash
   docker build -t cashbook-frontend .
   ```

3. Запустите контейнер:

   ```bash
   docker run -p 3000:80 --name cashbook-frontend-container cashbook-frontend
   ```

4. Получите доступ к приложению по адресу [http://localhost:3000](http://localhost:3000)

5. Остановите контейнер:
   ```bash
   docker stop cashbook-frontend-container
   ```

### Вариант 2: Использование Docker Compose (Рекомендуется)

1. Убедитесь, что у вас есть скомпилированное приложение в папке `build/`
   (Если папка build уже содержит актуальную версию приложения, этот шаг можно пропустить)

2. Запустите приложение:

   ```bash
   docker-compose up -d
   ```

3. Получите доступ к приложению по адресу [http://localhost:3000](http://localhost:3000)

4. Остановите приложение:
   ```bash
   docker-compose down
   ```

## Преимущества данного подхода

- **Быстрая сборка Docker-образа**: так как мы используем уже скомпилированное приложение, сборка Docker-образа занимает минимальное время
- **Меньший размер образа**: только Nginx и ваше приложение, без Node.js и других инструментов сборки
- **Контроль над процессом сборки**: вы можете использовать свои специфические настройки для сборки приложения перед контейнеризацией

## Переменные окружения

Для React-приложения переменные окружения должны быть заданы во время сборки, а не во время запуска контейнера. Поэтому, если вам нужно настроить окружение:

1. Установите переменные окружения перед сборкой:

   ```bash
   REACT_APP_API_URL=http://api.example.com npm run build
   ```

2. Затем используйте эту сборку для создания Docker-образа.

## Рекомендации для производственного развертывания

1. **HTTPS**: Для производственных развертываний настройте HTTPS. Вы можете использовать обратный прокси-сервер, такой как Nginx, или сервис вроде Cloudflare.

2. **Ограничения памяти**: Установите соответствующие ограничения памяти для ваших контейнеров в зависимости от ресурсов вашего сервера:

   ```yaml
   services:
     frontend:
       # ... другие настройки
       deploy:
         resources:
           limits:
             memory: 512M
   ```

3. **Проверки работоспособности**: Добавьте проверки здоровья, чтобы убедиться, что ваш контейнер работает правильно:
   ```yaml
   services:
     frontend:
       # ... другие настройки
       healthcheck:
         test: ["CMD", "curl", "-f", "http://localhost:80"]
         interval: 30s
         timeout: 10s
         retries: 3
   ```

## Устранение неполадок

1. **Контейнер не запускается**: Проверьте логи с помощью `docker logs cashbook-frontend-container`

2. **Нет доступа к приложению**: Убедитесь, что порт 3000 не используется другим приложением

3. **Приложение не отображается или отображается некорректно**: Убедитесь, что папка `build` содержит актуальную версию приложения
